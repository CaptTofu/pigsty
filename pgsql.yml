#!/usr/bin/env ansible-playbook
---
#==============================================================#
# File      :   pgsql.yml
# Mtime     :   2020-05-12
# Mtime     :   2021-04-22
# Desc      :   initialize pigsty cluster
# Path      :   pgsql.yml
# Copyright (C) 2018-2021 Ruohang Feng
#==============================================================#


#------------------------------------------------------------------------------
# init pgsql clusters
#------------------------------------------------------------------------------
# pgsql init assume that target nodes have already been initialized with `node.yml`
# if you just want re-init instance with same identity, ./pgsql.yml is sufficient


- name: Pgsql Init
  become: yes
  hosts: all
  gather_facts: no
  tags: pgsql
  roles:

    - role: node                            # init node
      tags: [ infra, node ]

    - role: consul                          # init consul
      tags: [ infra, dcs ]

    - role: postgres                        # init postgres
      tags: [postgres]

    - role: monitor                         # init monitor system
      tags: [monitor]

    - role: service                         # init service
      tags: [service]

    - role: register                        # register pgsql
      tags: [register]



...
