<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 --><!-- Title: pgsql&#45;createuser.yml  Pages: 1 --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1459pt" height="466pt" viewBox="0.00 0.00 1458.80 465.55" id="svg">
<script type="text/javascript" href="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" id="jquery"/><script type="text/javascript" id="my_javascript"><![CDATA[const HOVER_CLASS = "my_hover";

var selectedElement = null;

function addClass(rootElement) {
    $(rootElement).find('link').each(function (index, element) {
        var target = $(element).attr('target');
        var currentElement = $('#' + target);
        currentElement.addClass(HOVER_CLASS);

        addClass(currentElement);
    })
}

function removeClass(rootElement, hover) {
    $(rootElement).find('link').each(function (index, element) {
        if ($(rootElement).attr('id') !== $(selectedElement).attr('id') || !hover) {
            var target = $(element).attr('target');
            var currentElement = $('#' + target);
            currentElement.removeClass(HOVER_CLASS);

            removeClass(currentElement);
        }

    })
}

function hoverIn(event) {
    addClass(event.currentTarget);
}

function hoverOut(event) {
    removeClass(event.currentTarget, true);
}

function clickOnElement(event) {
    var newElement = event.currentTarget;

    if ($(newElement).attr('id') === $(selectedElement).attr('id')) {
        removeClass(selectedElement, false);
    } else {
        removeClass(selectedElement);
        addClass(newElement)
    }

    selectedElement = newElement;
}


$("#svg").ready(function () {

    $("g[id^=play_]").hover(hoverIn, hoverOut);
    $("g[id^=role_]").hover(hoverIn, hoverOut);

    $("g[id^=play_]").click(clickOnElement);
    $("g[id^=role_]").click(clickOnElement);

});
]]></script><style type="text/css" id="my_css"><![CDATA[.node:hover, .edge:hover, path:hover, path + polygon:hover {
    cursor: pointer;
    stroke-width: 3;
    font-weight: bolder;
}

.my_hover {
    cursor: pointer;
    stroke-width: 3;
    font-weight: bolder;
}
]]></style><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 461.55)">
<title>pgsql-createuser.yml </title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-461.55 1454.8,-461.55 1454.8,4 -4,4"/>
<!-- pgsql&#45;createuser.yml -->
<g id="root_node" class="node">
<title>pgsql-createuser.yml</title>
<ellipse fill="none" stroke="black" stroke-dasharray="1,5" cx="84.49" cy="-240.55" rx="84.49" ry="18"/>
<text text-anchor="middle" x="84.49" y="-236.85" font-family="Times,serif" font-size="14.00">pgsql-createuser.yml</text>
</g>
<!-- Play #1: Create new postgres user (4) -->
<g id="play_a591ce7c-e7b1-4466-929d-c9610c0f5922" class="node">
<title>Play #1: Create new postgres user (4)</title>
<g id="a_play_a591ce7c-e7b1-4466-929d-c9610c0f5922"><a xlink:title="10.10.10.10     10.10.10.11     10.10.10.12     10.10.10.13">
<polygon fill="#36a65f" stroke="#36a65f" points="432.99,-258.55 211.99,-258.55 211.99,-222.55 432.99,-222.55 432.99,-258.55"/>
<text text-anchor="middle" x="322.49" y="-236.85" font-family="Times,serif" font-size="14.00" fill="#ffffff">Play #1: Create new postgres user (4)</text>
</a>
</g>
<links><link target="edge_a4c15de5-bc78-4c56-8b77-df4b5f20a4bb"/><link target="edge_230fcc0e-dc04-4433-b10a-d7997ddbbc62"/><link target="edge_560a48b7-4b53-46be-9214-68dbcb08eb4b"/><link target="edge_9a298449-a483-4801-9891-f2b3f77243a5"/><link target="edge_1a54dea6-9b0b-4617-9071-9ea5637577c0"/><link target="edge_5019e14b-ca66-4f36-b23a-40ab2aeb03fc"/><link target="edge_0d08bd63-741d-4a05-a282-023bdc345991"/><link target="edge_b17ae835-30a8-4df2-bf12-21a0b12b9598"/></links></g>
<!-- pgsql&#45;createuser.yml&#45;&gt;Play #1: Create new postgres user (4) -->
<g id="edge_ea0ae6f5-9688-42ef-a415-26ba99a17533" class="edge">
<title>pgsql-createuser.yml-&gt;Play #1: Create new postgres user (4)</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M169.03,-240.55C179.58,-240.55 190.55,-240.55 201.53,-240.55"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="201.61,-244.05 211.61,-240.55 201.61,-237.05 201.61,-244.05"/>
<text text-anchor="middle" x="190.49" y="-244.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">1</text>
</g>
<!-- task_3cf622f6&#45;721e&#45;4be9&#45;bc30&#45;1348a7e61d22 -->
<g id="task_3cf622f6-721e-4be9-bc30-1348a7e61d22" class="node">
<title>task_3cf622f6-721e-4be9-bc30-1348a7e61d22</title>
<polygon fill="none" stroke="black" points="1307.19,-422.09 1307.19,-437 1248.73,-447.55 1166.06,-447.55 1107.6,-437 1107.6,-422.09 1166.06,-411.55 1248.73,-411.55 1307.19,-422.09"/>
<text text-anchor="middle" x="1207.39" y="-425.85" font-family="Times,serif" font-size="14.00">[task] Validate pg_user</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_3cf622f6&#45;721e&#45;4be9&#45;bc30&#45;1348a7e61d22 -->
<g id="edge_a4c15de5-bc78-4c56-8b77-df4b5f20a4bb" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_3cf622f6-721e-4be9-bc30-1348a7e61d22</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M331.68,-258.72C348.4,-293.3 390.07,-367.88 450.99,-398.55 561.01,-453.94 915.8,-444.77 1097.27,-435.94"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="1097.56,-439.43 1107.38,-435.44 1097.22,-432.43 1097.56,-439.43"/>
<text text-anchor="middle" x="698.49" y="-446.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">1</text>
<links><link target="task_3cf622f6-721e-4be9-bc30-1348a7e61d22"/></links></g>
<!-- task_192b8c25&#45;1965&#45;48f3&#45;ad11&#45;09ecffbd4cc3 -->
<g id="task_192b8c25-1965-48f3-ad11-09ecffbd4cc3" class="node">
<title>task_192b8c25-1965-48f3-ad11-09ecffbd4cc3</title>
<polygon fill="none" stroke="black" points="1322.23,-368.09 1322.23,-383 1254.96,-393.55 1159.83,-393.55 1092.55,-383 1092.55,-368.09 1159.83,-357.55 1254.96,-357.55 1322.23,-368.09"/>
<text text-anchor="middle" x="1207.39" y="-371.85" font-family="Times,serif" font-size="14.00">[task] Fetch user definition</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_192b8c25&#45;1965&#45;48f3&#45;ad11&#45;09ecffbd4cc3 -->
<g id="edge_230fcc0e-dc04-4433-b10a-d7997ddbbc62" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_192b8c25-1965-48f3-ad11-09ecffbd4cc3</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M339.88,-258.91C362.29,-282.53 404.98,-322.55 450.99,-339.55 563.17,-381 898.25,-381.69 1082.17,-378.63"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="1082.5,-382.13 1092.43,-378.46 1082.37,-375.13 1082.5,-382.13"/>
<text text-anchor="middle" x="698.49" y="-383.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">2</text>
<links><link target="task_192b8c25-1965-48f3-ad11-09ecffbd4cc3"/></links></g>
<!-- task_7afaf922&#45;5820&#45;44ed&#45;81d0&#45;d448e7bcf871 -->
<g id="task_7afaf922-5820-44ed-81d0-d448e7bcf871" class="node">
<title>task_7afaf922-5820-44ed-81d0-d448e7bcf871</title>
<polygon fill="none" stroke="black" points="1324.86,-314.09 1324.86,-329 1256.05,-339.55 1158.74,-339.55 1089.93,-329 1089.93,-314.09 1158.74,-303.55 1256.05,-303.55 1324.86,-314.09"/>
<text text-anchor="middle" x="1207.39" y="-317.85" font-family="Times,serif" font-size="14.00">[task] Check user definition</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_7afaf922&#45;5820&#45;44ed&#45;81d0&#45;d448e7bcf871 -->
<g id="edge_560a48b7-4b53-46be-9214-68dbcb08eb4b" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_7afaf922-5820-44ed-81d0-d448e7bcf871</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M374.02,-258.56C397.17,-266.05 425.16,-274.03 450.99,-278.55 669.49,-316.79 928.43,-323.29 1079.38,-323.29"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="1079.61,-326.79 1089.61,-323.28 1079.6,-319.79 1079.61,-326.79"/>
<text text-anchor="middle" x="698.49" y="-324.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">3</text>
<links><link target="task_7afaf922-5820-44ed-81d0-d448e7bcf871"/></links></g>
<!-- task_8dfab579&#45;2ef7&#45;46f8&#45;8be9&#45;2c5cc951869c -->
<g id="task_8dfab579-2ef7-46f8-8be9-2c5cc951869c" class="node">
<title>task_8dfab579-2ef7-46f8-8be9-2c5cc951869c</title>
<polygon fill="none" stroke="black" points="1266.58,-260.09 1266.58,-275 1231.91,-285.55 1182.88,-285.55 1148.21,-275 1148.21,-260.09 1182.88,-249.55 1231.91,-249.55 1266.58,-260.09"/>
<text text-anchor="middle" x="1207.39" y="-263.85" font-family="Times,serif" font-size="14.00">[task] debug</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_8dfab579&#45;2ef7&#45;46f8&#45;8be9&#45;2c5cc951869c -->
<g id="edge_9a298449-a483-4801-9891-f2b3f77243a5" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_8dfab579-2ef7-46f8-8be9-2c5cc951869c</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M433.08,-243.9C617.83,-249.55 986,-260.81 1138.15,-265.46"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="1138.19,-268.96 1148.3,-265.77 1138.41,-261.97 1138.19,-268.96"/>
<text text-anchor="middle" x="698.49" y="-263.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">4</text>
<links><link target="task_8dfab579-2ef7-46f8-8be9-2c5cc951869c"/></links></g>
<!-- task_260f9b0b&#45;d5b6&#45;4c1b&#45;8d7a&#45;fbc8d9a80e61 -->
<g id="task_260f9b0b-d5b6-4c1b-8d7a-fbc8d9a80e61" class="node">
<title>task_260f9b0b-d5b6-4c1b-8d7a-fbc8d9a80e61</title>
<polygon fill="none" stroke="black" points="1402.13,-206.09 1402.13,-221 1288.06,-231.55 1126.73,-231.55 1012.66,-221 1012.66,-206.09 1126.73,-195.55 1288.06,-195.55 1402.13,-206.09"/>
<text text-anchor="middle" x="1207.39" y="-209.85" font-family="Times,serif" font-size="14.00">[task] Render user {{ user.name }} creation sql</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_260f9b0b&#45;d5b6&#45;4c1b&#45;8d7a&#45;fbc8d9a80e61 -->
<g id="edge_1a54dea6-9b0b-4617-9071-9ea5637577c0" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_260f9b0b-d5b6-4c1b-8d7a-fbc8d9a80e61</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M433.29,-225.99C439.27,-225.44 445.2,-224.95 450.99,-224.55 637.25,-211.55 849.94,-209.6 1002.08,-210.44"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="1002.45,-213.94 1012.47,-210.5 1002.49,-206.94 1002.45,-213.94"/>
<text text-anchor="middle" x="698.49" y="-228.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">1  [when: pg_role == 'primary']</text>
<links><link target="task_260f9b0b-d5b6-4c1b-8d7a-fbc8d9a80e61"/></links></g>
<!-- task_50ae4262&#45;32f0&#45;4860&#45;8661&#45;64b716a584d7 -->
<g id="task_50ae4262-32f0-4860-8661-64b716a584d7" class="node">
<title>task_50ae4262-32f0-4860-8661-64b716a584d7</title>
<polygon fill="none" stroke="black" points="1450.71,-152.09 1450.71,-167 1308.18,-177.55 1106.61,-177.55 964.08,-167 964.08,-152.09 1106.61,-141.55 1308.18,-141.55 1450.71,-152.09"/>
<text text-anchor="middle" x="1207.39" y="-155.85" font-family="Times,serif" font-size="14.00">[task] Execute user {{ user.name }} creation sql on primary</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_50ae4262&#45;32f0&#45;4860&#45;8661&#45;64b716a584d7 -->
<g id="edge_5019e14b-ca66-4f36-b23a-40ab2aeb03fc" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_50ae4262-32f0-4860-8661-64b716a584d7</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M359.86,-222.53C384.84,-211.1 419.11,-197.26 450.99,-190.55 628.5,-153.2 834.5,-147.14 986.5,-149.48"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="986.83,-152.98 996.89,-149.65 986.95,-145.98 986.83,-152.98"/>
<text text-anchor="middle" x="698.49" y="-194.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">2  [when: pg_role == 'primary']</text>
<links><link target="task_50ae4262-32f0-4860-8661-64b716a584d7"/></links></g>
<!-- task_0035984f&#45;9663&#45;45d1&#45;ad93&#45;284dd1b1c2a7 -->
<g id="task_0035984f-9663-45d1-ad93-284dd1b1c2a7" class="node">
<title>task_0035984f-9663-45d1-ad93-284dd1b1c2a7</title>
<polygon fill="none" stroke="black" points="1365.06,-98.09 1365.06,-113 1272.7,-123.55 1142.09,-123.55 1049.73,-113 1049.73,-98.09 1142.09,-87.55 1272.7,-87.55 1365.06,-98.09"/>
<text text-anchor="middle" x="1207.39" y="-101.85" font-family="Times,serif" font-size="14.00">[task] Add business user to pgbouncer</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_0035984f&#45;9663&#45;45d1&#45;ad93&#45;284dd1b1c2a7 -->
<g id="edge_0d08bd63-741d-4a05-a282-023bdc345991" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_0035984f-9663-45d1-ad93-284dd1b1c2a7</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M337.17,-222.55C358.28,-196.41 401.54,-148.96 450.99,-129.55 554.18,-89.04 850.26,-91.55 1039.64,-97.94"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="1039.59,-101.44 1049.7,-98.29 1039.83,-94.45 1039.59,-101.44"/>
<text text-anchor="middle" x="698.49" y="-133.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">3  [when: user.pgbouncer is defined and user.pgbouncer|bool]</text>
<links><link target="task_0035984f-9663-45d1-ad93-284dd1b1c2a7"/></links></g>
<!-- task_f585d3ef&#45;8bf6&#45;4694&#45;be5a&#45;fbe2f3f639fe -->
<g id="task_f585d3ef-8bf6-4694-be5a-fbe2f3f639fe" class="node">
<title>task_f585d3ef-8bf6-4694-be5a-fbe2f3f639fe</title>
<polygon fill="none" stroke="black" points="1357.99,-44.09 1357.99,-59 1269.77,-69.55 1145.02,-69.55 1056.8,-59 1056.8,-44.09 1145.02,-33.55 1269.77,-33.55 1357.99,-44.09"/>
<text text-anchor="middle" x="1207.39" y="-47.85" font-family="Times,serif" font-size="14.00">[task] Reload pgbouncer to add user</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_f585d3ef&#45;8bf6&#45;4694&#45;be5a&#45;fbe2f3f639fe -->
<g id="edge_b17ae835-30a8-4df2-bf12-21a0b12b9598" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_f585d3ef-8bf6-4694-be5a-fbe2f3f639fe</title>
<path fill="none" stroke="#36a65f" stroke-width="2" d="M330.89,-222.54C346.74,-186.66 387.75,-106.92 450.99,-74.55 672.54,38.87 980.53,-3.17 1125.21,-32.55"/>
<polygon fill="#36a65f" stroke="#36a65f" stroke-width="2" points="1124.84,-36.05 1135.34,-34.65 1126.26,-29.2 1124.84,-36.05"/>
<text text-anchor="middle" x="698.49" y="-78.35" font-family="Times,serif" font-size="14.00" fill="#36a65f">4  [when: pg_user_definition.pgbouncer is defined and pg_user_definition.pgbouncer|bool]</text>
<links><link target="task_f585d3ef-8bf6-4694-be5a-fbe2f3f639fe"/></links></g>
</g>
</svg>