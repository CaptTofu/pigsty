<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 --><!-- Title: pgsql&#45;createuser.yml  Pages: 1 --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1459pt" height="466pt" viewBox="0.00 0.00 1458.80 465.55" id="svg">
<script type="text/javascript" href="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" id="jquery"/><script type="text/javascript" id="my_javascript"><![CDATA[const HOVER_CLASS = "my_hover";

var selectedElement = null;

function addClass(rootElement) {
    $(rootElement).find('link').each(function (index, element) {
        var target = $(element).attr('target');
        var currentElement = $('#' + target);
        currentElement.addClass(HOVER_CLASS);

        addClass(currentElement);
    })
}

function removeClass(rootElement, hover) {
    $(rootElement).find('link').each(function (index, element) {
        if ($(rootElement).attr('id') !== $(selectedElement).attr('id') || !hover) {
            var target = $(element).attr('target');
            var currentElement = $('#' + target);
            currentElement.removeClass(HOVER_CLASS);

            removeClass(currentElement);
        }

    })
}

function hoverIn(event) {
    addClass(event.currentTarget);
}

function hoverOut(event) {
    removeClass(event.currentTarget, true);
}

function clickOnElement(event) {
    var newElement = event.currentTarget;

    if ($(newElement).attr('id') === $(selectedElement).attr('id')) {
        removeClass(selectedElement, false);
    } else {
        removeClass(selectedElement);
        addClass(newElement)
    }

    selectedElement = newElement;
}


$("#svg").ready(function () {

    $("g[id^=play_]").hover(hoverIn, hoverOut);
    $("g[id^=role_]").hover(hoverIn, hoverOut);

    $("g[id^=play_]").click(clickOnElement);
    $("g[id^=role_]").click(clickOnElement);

});
]]></script><style type="text/css" id="my_css"><![CDATA[.node:hover, .edge:hover, path:hover, path + polygon:hover {
    cursor: pointer;
    stroke-width: 3;
    font-weight: bolder;
}

.my_hover {
    cursor: pointer;
    stroke-width: 3;
    font-weight: bolder;
}
]]></style><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 461.55)">
<title>pgsql-createuser.yml </title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-461.55 1454.8,-461.55 1454.8,4 -4,4"/>
<!-- pgsql&#45;createuser.yml -->
<g id="root_node" class="node">
<title>pgsql-createuser.yml</title>
<ellipse fill="none" stroke="black" stroke-dasharray="1,5" cx="84.49" cy="-240.55" rx="84.49" ry="18"/>
<text text-anchor="middle" x="84.49" y="-236.85" font-family="Times,serif" font-size="14.00">pgsql-createuser.yml</text>
</g>
<!-- Play #1: Create new postgres user (4) -->
<g id="play_fff87f93-9ce8-48f7-9c56-4b2f0a0000ad" class="node">
<title>Play #1: Create new postgres user (4)</title>
<g id="a_play_fff87f93-9ce8-48f7-9c56-4b2f0a0000ad"><a xlink:title="10.10.10.10     10.10.10.11     10.10.10.12     10.10.10.13">
<polygon fill="#de4fe2" stroke="#de4fe2" points="432.99,-258.55 211.99,-258.55 211.99,-222.55 432.99,-222.55 432.99,-258.55"/>
<text text-anchor="middle" x="322.49" y="-236.85" font-family="Times,serif" font-size="14.00" fill="#ffffff">Play #1: Create new postgres user (4)</text>
</a>
</g>
<links><link target="edge_34a76950-7fb2-4907-b868-81911ab05450"/><link target="edge_668870d4-827d-4c41-8d64-6b037b917060"/><link target="edge_f0447a6b-8902-4e5b-a4a7-71f72fb9608d"/><link target="edge_f55534bf-fb6a-4d96-8f66-24768e2e5e03"/><link target="edge_5fcc49ff-3ad9-40b4-91fc-6db9ba3e853f"/><link target="edge_5e184545-ee82-4612-a891-b23eb659110d"/><link target="edge_f9262db3-bd4d-49bc-8c12-b44503b991c0"/><link target="edge_59bc0783-37f6-4f4e-ab8a-c3d6938c5444"/></links></g>
<!-- pgsql&#45;createuser.yml&#45;&gt;Play #1: Create new postgres user (4) -->
<g id="edge_9e70e68e-3ec7-4f1e-876a-ccb6178753bb" class="edge">
<title>pgsql-createuser.yml-&gt;Play #1: Create new postgres user (4)</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M169.03,-240.55C179.58,-240.55 190.55,-240.55 201.53,-240.55"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="201.61,-244.05 211.61,-240.55 201.61,-237.05 201.61,-244.05"/>
<text text-anchor="middle" x="190.49" y="-244.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">1</text>
</g>
<!-- task_b6dc2785&#45;8e62&#45;4368&#45;8ea2&#45;fc0898005b1d -->
<g id="task_b6dc2785-8e62-4368-8ea2-fc0898005b1d" class="node">
<title>task_b6dc2785-8e62-4368-8ea2-fc0898005b1d</title>
<polygon fill="none" stroke="black" points="1307.19,-422.09 1307.19,-437 1248.73,-447.55 1166.06,-447.55 1107.6,-437 1107.6,-422.09 1166.06,-411.55 1248.73,-411.55 1307.19,-422.09"/>
<text text-anchor="middle" x="1207.39" y="-425.85" font-family="Times,serif" font-size="14.00">[task] Validate pg_user</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_b6dc2785&#45;8e62&#45;4368&#45;8ea2&#45;fc0898005b1d -->
<g id="edge_34a76950-7fb2-4907-b868-81911ab05450" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_b6dc2785-8e62-4368-8ea2-fc0898005b1d</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M331.68,-258.72C348.4,-293.3 390.07,-367.88 450.99,-398.55 561.01,-453.94 915.8,-444.77 1097.27,-435.94"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="1097.56,-439.43 1107.38,-435.44 1097.22,-432.43 1097.56,-439.43"/>
<text text-anchor="middle" x="698.49" y="-446.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">1</text>
<links><link target="task_b6dc2785-8e62-4368-8ea2-fc0898005b1d"/></links></g>
<!-- task_2b8bdfd4&#45;7d30&#45;478e&#45;a592&#45;2528eb0fae79 -->
<g id="task_2b8bdfd4-7d30-478e-a592-2528eb0fae79" class="node">
<title>task_2b8bdfd4-7d30-478e-a592-2528eb0fae79</title>
<polygon fill="none" stroke="black" points="1322.23,-368.09 1322.23,-383 1254.96,-393.55 1159.83,-393.55 1092.55,-383 1092.55,-368.09 1159.83,-357.55 1254.96,-357.55 1322.23,-368.09"/>
<text text-anchor="middle" x="1207.39" y="-371.85" font-family="Times,serif" font-size="14.00">[task] Fetch user definition</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_2b8bdfd4&#45;7d30&#45;478e&#45;a592&#45;2528eb0fae79 -->
<g id="edge_668870d4-827d-4c41-8d64-6b037b917060" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_2b8bdfd4-7d30-478e-a592-2528eb0fae79</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M339.88,-258.91C362.29,-282.53 404.98,-322.55 450.99,-339.55 563.17,-381 898.25,-381.69 1082.17,-378.63"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="1082.5,-382.13 1092.43,-378.46 1082.37,-375.13 1082.5,-382.13"/>
<text text-anchor="middle" x="698.49" y="-383.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">2</text>
<links><link target="task_2b8bdfd4-7d30-478e-a592-2528eb0fae79"/></links></g>
<!-- task_ee626817&#45;60d3&#45;4fac&#45;8229&#45;e1fbd7e82dff -->
<g id="task_ee626817-60d3-4fac-8229-e1fbd7e82dff" class="node">
<title>task_ee626817-60d3-4fac-8229-e1fbd7e82dff</title>
<polygon fill="none" stroke="black" points="1324.86,-314.09 1324.86,-329 1256.05,-339.55 1158.74,-339.55 1089.93,-329 1089.93,-314.09 1158.74,-303.55 1256.05,-303.55 1324.86,-314.09"/>
<text text-anchor="middle" x="1207.39" y="-317.85" font-family="Times,serif" font-size="14.00">[task] Check user definition</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_ee626817&#45;60d3&#45;4fac&#45;8229&#45;e1fbd7e82dff -->
<g id="edge_f0447a6b-8902-4e5b-a4a7-71f72fb9608d" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_ee626817-60d3-4fac-8229-e1fbd7e82dff</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M374.02,-258.56C397.17,-266.05 425.16,-274.03 450.99,-278.55 669.49,-316.79 928.43,-323.29 1079.38,-323.29"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="1079.61,-326.79 1089.61,-323.28 1079.6,-319.79 1079.61,-326.79"/>
<text text-anchor="middle" x="698.49" y="-324.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">3</text>
<links><link target="task_ee626817-60d3-4fac-8229-e1fbd7e82dff"/></links></g>
<!-- task_c40c4331&#45;2437&#45;48d8&#45;b3e9&#45;76dfe70aff16 -->
<g id="task_c40c4331-2437-48d8-b3e9-76dfe70aff16" class="node">
<title>task_c40c4331-2437-48d8-b3e9-76dfe70aff16</title>
<polygon fill="none" stroke="black" points="1266.58,-260.09 1266.58,-275 1231.91,-285.55 1182.88,-285.55 1148.21,-275 1148.21,-260.09 1182.88,-249.55 1231.91,-249.55 1266.58,-260.09"/>
<text text-anchor="middle" x="1207.39" y="-263.85" font-family="Times,serif" font-size="14.00">[task] debug</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_c40c4331&#45;2437&#45;48d8&#45;b3e9&#45;76dfe70aff16 -->
<g id="edge_f55534bf-fb6a-4d96-8f66-24768e2e5e03" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_c40c4331-2437-48d8-b3e9-76dfe70aff16</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M433.08,-243.9C617.83,-249.55 986,-260.81 1138.15,-265.46"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="1138.19,-268.96 1148.3,-265.77 1138.41,-261.97 1138.19,-268.96"/>
<text text-anchor="middle" x="698.49" y="-263.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">4</text>
<links><link target="task_c40c4331-2437-48d8-b3e9-76dfe70aff16"/></links></g>
<!-- task_8fbe4047&#45;e39c&#45;4f88&#45;b7a9&#45;9e5dc7150859 -->
<g id="task_8fbe4047-e39c-4f88-b7a9-9e5dc7150859" class="node">
<title>task_8fbe4047-e39c-4f88-b7a9-9e5dc7150859</title>
<polygon fill="none" stroke="black" points="1402.13,-206.09 1402.13,-221 1288.06,-231.55 1126.73,-231.55 1012.66,-221 1012.66,-206.09 1126.73,-195.55 1288.06,-195.55 1402.13,-206.09"/>
<text text-anchor="middle" x="1207.39" y="-209.85" font-family="Times,serif" font-size="14.00">[task] Render user {{ user.name }} creation sql</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_8fbe4047&#45;e39c&#45;4f88&#45;b7a9&#45;9e5dc7150859 -->
<g id="edge_5fcc49ff-3ad9-40b4-91fc-6db9ba3e853f" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_8fbe4047-e39c-4f88-b7a9-9e5dc7150859</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M433.29,-225.99C439.27,-225.44 445.2,-224.95 450.99,-224.55 637.25,-211.55 849.94,-209.6 1002.08,-210.44"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="1002.45,-213.94 1012.47,-210.5 1002.49,-206.94 1002.45,-213.94"/>
<text text-anchor="middle" x="698.49" y="-228.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">1  [when: pg_role == 'primary']</text>
<links><link target="task_8fbe4047-e39c-4f88-b7a9-9e5dc7150859"/></links></g>
<!-- task_fc29af17&#45;c4b3&#45;4425&#45;9598&#45;96608dcf9124 -->
<g id="task_fc29af17-c4b3-4425-9598-96608dcf9124" class="node">
<title>task_fc29af17-c4b3-4425-9598-96608dcf9124</title>
<polygon fill="none" stroke="black" points="1450.71,-152.09 1450.71,-167 1308.18,-177.55 1106.61,-177.55 964.08,-167 964.08,-152.09 1106.61,-141.55 1308.18,-141.55 1450.71,-152.09"/>
<text text-anchor="middle" x="1207.39" y="-155.85" font-family="Times,serif" font-size="14.00">[task] Execute user {{ user.name }} creation sql on primary</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_fc29af17&#45;c4b3&#45;4425&#45;9598&#45;96608dcf9124 -->
<g id="edge_5e184545-ee82-4612-a891-b23eb659110d" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_fc29af17-c4b3-4425-9598-96608dcf9124</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M359.86,-222.53C384.84,-211.1 419.11,-197.26 450.99,-190.55 628.5,-153.2 834.5,-147.14 986.5,-149.48"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="986.83,-152.98 996.89,-149.65 986.95,-145.98 986.83,-152.98"/>
<text text-anchor="middle" x="698.49" y="-194.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">2  [when: pg_role == 'primary']</text>
<links><link target="task_fc29af17-c4b3-4425-9598-96608dcf9124"/></links></g>
<!-- task_a9cdbc9d&#45;cf44&#45;4127&#45;b75f&#45;8e3e89d3389a -->
<g id="task_a9cdbc9d-cf44-4127-b75f-8e3e89d3389a" class="node">
<title>task_a9cdbc9d-cf44-4127-b75f-8e3e89d3389a</title>
<polygon fill="none" stroke="black" points="1365.06,-98.09 1365.06,-113 1272.7,-123.55 1142.09,-123.55 1049.73,-113 1049.73,-98.09 1142.09,-87.55 1272.7,-87.55 1365.06,-98.09"/>
<text text-anchor="middle" x="1207.39" y="-101.85" font-family="Times,serif" font-size="14.00">[task] Add business user to pgbouncer</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_a9cdbc9d&#45;cf44&#45;4127&#45;b75f&#45;8e3e89d3389a -->
<g id="edge_f9262db3-bd4d-49bc-8c12-b44503b991c0" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_a9cdbc9d-cf44-4127-b75f-8e3e89d3389a</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M337.17,-222.55C358.28,-196.41 401.54,-148.96 450.99,-129.55 554.18,-89.04 850.26,-91.55 1039.64,-97.94"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="1039.59,-101.44 1049.7,-98.29 1039.83,-94.45 1039.59,-101.44"/>
<text text-anchor="middle" x="698.49" y="-133.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">3  [when: user.pgbouncer is defined and user.pgbouncer|bool]</text>
<links><link target="task_a9cdbc9d-cf44-4127-b75f-8e3e89d3389a"/></links></g>
<!-- task_d5c13ee7&#45;fda1&#45;4624&#45;8220&#45;055ec5e530e2 -->
<g id="task_d5c13ee7-fda1-4624-8220-055ec5e530e2" class="node">
<title>task_d5c13ee7-fda1-4624-8220-055ec5e530e2</title>
<polygon fill="none" stroke="black" points="1357.99,-44.09 1357.99,-59 1269.77,-69.55 1145.02,-69.55 1056.8,-59 1056.8,-44.09 1145.02,-33.55 1269.77,-33.55 1357.99,-44.09"/>
<text text-anchor="middle" x="1207.39" y="-47.85" font-family="Times,serif" font-size="14.00">[task] Reload pgbouncer to add user</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_d5c13ee7&#45;fda1&#45;4624&#45;8220&#45;055ec5e530e2 -->
<g id="edge_59bc0783-37f6-4f4e-ab8a-c3d6938c5444" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_d5c13ee7-fda1-4624-8220-055ec5e530e2</title>
<path fill="none" stroke="#de4fe2" stroke-width="2" d="M330.89,-222.54C346.74,-186.66 387.75,-106.92 450.99,-74.55 672.54,38.87 980.53,-3.17 1125.21,-32.55"/>
<polygon fill="#de4fe2" stroke="#de4fe2" stroke-width="2" points="1124.84,-36.05 1135.34,-34.65 1126.26,-29.2 1124.84,-36.05"/>
<text text-anchor="middle" x="698.49" y="-78.35" font-family="Times,serif" font-size="14.00" fill="#de4fe2">4  [when: pg_user_definition.pgbouncer is defined and pg_user_definition.pgbouncer|bool]</text>
<links><link target="task_d5c13ee7-fda1-4624-8220-055ec5e530e2"/></links></g>
</g>
</svg>