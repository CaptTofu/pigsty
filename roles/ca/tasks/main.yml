---
#--------------------------------------------------------------------------
# Make Sure Self-Signed Root CA Exists on All Meta Nodes
#   ca_method (create|copy|recreate)
#     * none     : skip ca creation at all
#     * copy     : copy ca.{key,crt} from local files directly
#     * create   : create ca.{key|crt} if not exist on meta
#     * recreate : force recreate ca key & file on meta
#--------------------------------------------------------------------------

#------------------------------------------------------------------------------
# CA Create (on primary meta node)
#------------------------------------------------------------------------------
# create ca cert on meta nodes and copy to local files/cert dir when ca_method = (create,recreate)
# when ca_method = copy : it's user's responsibility to make sure ca exists under files/cert dir
# available tags for ca_create: ca_check, ca_gen, ca_fetch
- import_tasks: create.yml
  tags: ca_create
  when: meta_ip == inventory_hostname and ca_method != 'none' and ca_method != 'copy'

#------------------------------------------------------------------------------
# CA Sync (from primary meta node to local files, and to other meta nodes)
#------------------------------------------------------------------------------
- import_tasks: sync.yml
  tags: ca_sync
  when: meta_node|bool and ca_method != 'none'

#------------------------------------------------------------------------------
# CA Copy
#------------------------------------------------------------------------------
- import_tasks: copy.yml
  tags: ca_copy

...