---

#--------------------------------------------------------------#
# 1. Setup node timezone (if given)
#--------------------------------------------------------------#
- name: Setup default node timezone
  tags: node_timezone
  when: node_timezone is defined and node_timezone != ""
  timezone: name={{ node_timezone }}

#--------------------------------------------------------------#
# 2. Make sure chrony package installed
#--------------------------------------------------------------#
- name: Install chrony package
  tags: node_ntp
  block:

    # skip this because already installed in pkgs.yml
    # - name: Install chrony package
    #   tags: node_ntp_install
    #   package: name=chrony state=present

    - name: Configure /etc/chrony.conf
      tags: node_ntp_config
      template: src=chrony.conf.j2 dest=/etc/chrony.conf

    - name: Launch ntpd service
      tags: node_ntp_launch
      systemd: name=chronyd enabled=true state=restarted

...
