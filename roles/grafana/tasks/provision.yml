
#--------------------------------------------------------------#
# Provision grafana with grafana API
#--------------------------------------------------------------#
---
- name: Update grafana default organization
  ignore_errors: true
  shell: |
    #!/bin/bash

    # https://grafana.com/docs/grafana/latest/http_api/
    GRAFANA_ENDPOINT="{{ grafana_endpoint }}"          # http://localhost:3000
    GRAFANA_USERNAME="{{ grafana_admin_username }}"    # admin
    GRAFANA_PASSWORD="{{ grafana_admin_password }}"    # admin

    # update organization with grafana api
    curl -X PUT "${GRAFANA_ENDPOINT}/api/orgs/1"       \
         -u "${GRAFANA_USERNAME}:${GRAFANA_PASSWORD}"  \
         -H 'Content-Type: application/json'           \
         -d '{"name": "Pigsty"}'

...