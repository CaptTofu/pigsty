---
#------------------------------------------------------------------------------
# 1. Prepare Consul Env: Check & Cleanup & Dir & User
#------------------------------------------------------------------------------
# tasks: consul_check , consul_clean, consul_user, consul_dir
# abort if dcs_safeguard set to ture and consul is running
- import_tasks: prepare.yml
  tags: consul_prepare

#------------------------------------------------------------------------------
# Config Consul
#------------------------------------------------------------------------------
- import_tasks: config.yml
  tags: consul_config
  vars:
    dcs_nodename: "{% if inventory_hostname in dcs_servers.values() %}{{ (dcs_servers|dict2items|items2dict(key_name='value', value_name='key'))[inventory_hostname] }}{% else %}{{ nodename }}{% endif %}"

#------------------------------------------------------------------------------
# Launch Consul
#------------------------------------------------------------------------------
- import_tasks: launch.yml
  tags: consul_launch

...
