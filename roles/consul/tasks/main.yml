---
#------------------------------------------------------------------------------
# 1. Prepare Consul Env: Check & Cleanup & Dir & User
#------------------------------------------------------------------------------
# tasks: consul_check , consul_clean, consul_user, consul_dir
# abort if dcs_safeguard set to ture and consul is running
- import_tasks: prepare.yml
  tags: consul_prepare

# deliver consul ca to all nodes
- name: Copy consul ca certificates
  tags: consul_ca
  when: ca_method != 'none'
  copy: src="files/cert/ca.crt" dest="/var/lib/consul/ca.crt" owner=consul group=consul mode=0600

#------------------------------------------------------------------------------
# Config Consul
#------------------------------------------------------------------------------
- import_tasks: config.yml
  tags: consul_config

#------------------------------------------------------------------------------
# Launch Consul
#------------------------------------------------------------------------------
- import_tasks: launch.yml
  tags: consul_launch

...
